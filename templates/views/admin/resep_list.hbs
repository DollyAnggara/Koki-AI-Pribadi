<section class="bagian admin-resep-list view-table">
  <div class="kartu">
    <div class="admin-top">
      <div>
        <h2 class="kartu-judul">Daftar Resep</h2>
        <p class="muted">Kelola resep situs Anda. Klik baris untuk melihat detail.</p>
      </div>
      <div class="admin-top-actions">
        <a href="/admin/resep/new" class="tombol-kirim tombol-primer">Tambah Resep</a>
        <a href="/admin/resep/pending" class="tombol-kecil tombol-bahaya">Resep Pending</a>
      </div>
    </div>

    <div class="resep-controls">
      <div class="search-wrap">
        <input id="resepSearch" type="search" placeholder="Cari resep, kategori, pengirim..." aria-label="Cari resep" />
      </div>
      <div class="view-toggle" role="tablist" aria-label="Tampilan">
        <button id="btnGrid" class="toggle" data-view="grid" title="Grid">Grid</button>
        <button id="btnTable" class="toggle active" data-view="table" title="Tabel">Tabel</button>
      </div>
      <div class="resep-meta">
        <div class="total">Total: <strong>{{resep.length}}</strong></div>
      </div>
    </div>

    <div class="resep-grid">
      {{#each resep}}
        <article class="resep-card">
          <h3 class="card-judul">{{this.namaResep}}</h3>
          <div class="card-meta">
            <span class="badge kategori">{{this.kategoriLabel}}</span>
            {{#if this.isApproved}}
              <span class="badge status approved"><span class="badge-icon">✓</span>Approved</span>
            {{else if this.isPending}}
              <span class="badge status pending">Pending</span>
            {{else if this.isRejected}}
              <span class="badge status rejected">Rejected</span>
            {{else}}
              <span class="badge status">{{this.status}}</span>
            {{/if}}
          </div>
          {{#if this.deskripsi}}
            <div class="card-body muted">{{this.deskripsi}}</div>
          {{/if}}
          {{#if this.approvedAt}}
            <div class="muted small">Disetujui: {{this.approvedAt}}</div>
          {{/if}}
          <div class="card-sub">Pengirim: {{#if this.submittedBy}}{{#if this.submittedBy.namaPengguna}}{{this.submittedBy.namaPengguna}}{{else}}{{this.submittedBy}}{{/if}}{{else}}-{{/if}}</div>
          <div class="card-actions">
            <a href="/admin/resep/{{this._id}}/edit" class="tombol-kecil">Edit</a>
            <form method="post" action="/admin/resep/{{this._id}}/delete" style="display:inline" onsubmit="return confirm('Hapus resep ini?');">
              <button class="tombol-kecil tombol-bahaya">Hapus</button>
            </form>
          </div>
        </article>
      {{/each}}
    </div>

    <div class="table-wrap">
      <table class="tabel admin-table">
        <thead>
          <tr>
            <th style="width:40%">Nama</th>
            <th style="width:20%">Kategori</th>
            <th style="width:10%">Status</th>
            <th style="width:20%">Pengirim</th>
            <th style="width:10%"></th>
          </tr>
        </thead>
        <tbody>
          {{#each resep}}
            <tr>
              <td>{{this.namaResep}}</td>
              <td>{{this.kategoriLabel}}</td>
              <td class="status-cell">
                {{#if this.isApproved}}
                  <span class="badge status approved"><span class="badge-icon">✓</span>Approved</span>
                  {{#if this.approvedAt}}<div class="muted small">Disetujui: {{this.approvedAt}}</div>{{/if}}
                {{else if this.isPending}}
                  <span class="badge status pending">Pending</span>
                {{else if this.isRejected}}
                  <span class="badge status rejected">Rejected</span>
                {{else}}
                  <span class="badge status">{{this.status}}</span>
                {{/if}}
              </td>
              <td>
                {{#if this.submittedBy}}
                  {{#if this.submittedBy.namaPengguna}}
                    {{this.submittedBy.namaPengguna}}
                  {{else}}
                    {{this.submittedBy}}
                  {{/if}}
                {{else}}-{{/if}}
              </td>
              <td class="aksi-cell">
                <a href="/admin/resep/{{this._id}}/edit" class="tombol-kecil">Edit</a>
                <form method="post" action="/admin/resep/{{this._id}}/delete" style="display:inline" onsubmit="return confirm('Hapus resep ini?');">
                  <button class="tombol-kecil tombol-bahaya">Hapus</button>
                </form>
              </td>
            </tr>
          {{/each}}
        </tbody>
      </table>
    </div> 
  </div>
</section>
<script src="/js/admin.js"></script>