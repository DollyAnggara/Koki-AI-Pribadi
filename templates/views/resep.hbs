<main class="kontainer-utama">
  <section>
    <div class="kartu">
      <h2 class="kartu-judul">ğŸ“– Daftar Resep</h2>
      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;justify-content:space-between;">
        <div style="flex:1;min-width:220px"><input type="text" class="form-input" id="cariResep" placeholder="ğŸ” Cari resep..."></div>
        <div style="display:flex;gap:8px;align-items:center;margin-left:12px"><button id="tombolTambahResep" class="tombol-kirim">ï¼‹ Tambah Resep</button></div>
      </div>
      <p style="margin-top:8px;color:var(--warna-teks-sekunder);font-size:0.95rem;">Klik kartu resep untuk melihat bahan dan langkah pembuatan.</p>

      {{#if counts}}
        <div id="resepInfoBar" style="margin-top:8px;color:var(--warna-teks-secondary);font-size:0.95rem;">Total: {{counts.total}} â€¢ Approved: {{counts.approved}} â€¢ Pending: {{counts.pending}} â€¢ Rejected: {{counts.rejected}}</div>
      {{/if}}

      <div id="formTambahResep" class="kartu" style="display:none;margin-top:12px;">
        <h3 class="kartu-judul">Tambah Resep Baru</h3>
        <div class="form-grup"><input id="inputNamaResep" class="form-input" placeholder="Nama Resep" required></div>
        <div class="form-grup"><textarea id="inputDeskripsi" class="form-input" placeholder="Deskripsi (opsional)" rows="2"></textarea></div>
        <div style="display:flex;gap:8px;">
          <input id="inputPorsi" type="number" min="1" class="form-input" placeholder="Porsi" style="width:80px;">
          <input id="inputWaktuPersiapan" type="number" min="0" class="form-input" placeholder="Waktu persiapan (menit)" style="width:180px;">
          <input id="inputWaktuMemasak" type="number" min="0" class="form-input" placeholder="Waktu memasak (menit)" style="width:180px;">
        </div>
        <div class="form-grup">
          <label><strong>Bahan</strong></label>
          
          <!-- Form Input Bahan -->
          <div style="display: grid; grid-template-columns: 1fr 1fr 150px 80px; gap: 8px; margin-bottom: 12px;">
            <input
              type="text"
              id="inputNamaBahanForm"
              placeholder="Nama bahan"
              style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;"
            />
            <input
              type="number"
              id="inputJumlahBahanForm"
              placeholder="Jumlah"
              min="0.1"
              step="0.1"
              style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;"
            />
            <select
              id="inputSatuanBahanForm"
              style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;"
            >
              <option value="gram">gram</option>
              <option value="kg">kg</option>
              <option value="liter">liter</option>
              <option value="ml">ml</option>
              <option value="butir">butir</option>
              <option value="potong">potong</option>
            </select>
            <button
              type="button"
              id="tombolTambahBahanForm"
              style="padding: 8px; background: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500; font-size: 13px;"
            >
              Tambah
            </button>
          </div>

          <!-- Daftar Bahan yang Ditambahkan -->
          <div id="daftarBahanForm" style="background: #f8f9fa; padding: 10px; border-radius: 4px; min-height: 60px; border: 1px solid #e0e0e0; margin-bottom: 12px;">
            <div id="bahanListContainerForm" style="display: flex; flex-direction: column; gap: 6px;">
              <p style="color: #999; text-align: center; margin: 10px 0; font-size: 13px;">Belum ada bahan ditambahkan</p>
            </div>
          </div>

          <!-- Hidden Input untuk Form Submission -->
          <textarea
            id="inputBahan"
            class="form-input"
            style="display: none;"
            required
          ></textarea>

          <p style="color: var(--warna-teks-sekunder); font-size: 12px; margin-top: 8px;">Cukup isi nama bahan, jumlah, dan satuan. Klik "Tambah" untuk menambahkan ke daftar.</p>
        </div>
        <div class="form-grup">
          <label>Langkah (satu per baris)</label>
          <textarea id="inputLangkah" class="form-input" placeholder="contoh: Kupas dan potong wortel
Rebus wortel" rows="4"></textarea>
        </div>
        <div style="display:flex;gap:8px;">
          <button id="tombolSimpanResep" class="tombol-kirim">Simpan</button>
          <button id="tombolBatalResep" class="tombol-batal">Batal</button>
        </div>
        <small style="color:var(--warna-teks-sekunder);">Cukup isi nama resep dan minimal satu bahan (satu baris = satu bahan). Format jumlah/satuan opsional.</small>
      </div>
    </div>
    <div class="grid-resep" id="daftarResep">
      {{#if resep.length}}
        {{#each resep}}
        <div class="kartu-resep" data-id="{{this._id}}">
          <div class="gambar-resep">ğŸ²</div>
          <div class="info-resep">
            <div class="nama-resep">{{this.nama}}</div>
            <div class="meta-resep"><span>â±ï¸ {{this.waktu}} menit</span><span>ğŸ”¥ {{this.kalori}} kkal</span></div>
            <div class="detail-resep" id="detail_{{this._id}}" style="display:none;margin-top:8px;"></div>
          </div>
        </div>
        {{/each}}
      {{else}}
        <div class="kartu">
          <p>Tidak ada resep untuk ditampilkan. Coba tambah resep atau jalankan seed database.</p>
        </div>
      {{/if}}
    </div>
  </section>
</main>

{{> footer}}