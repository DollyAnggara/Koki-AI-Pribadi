<main class="kontainer-utama">
  <section>
    <div class="kartu">
      {{#if resep}}
      <h2 class="kartu-judul">ğŸ“– {{resep.nama}}</h2>
      <div style="color:var(--warna-teks-sekunder);margin-bottom:8px;">â±ï¸ {{resep.waktu}} menit â€¢ ğŸ”¥ {{resep.kalori}} kkal â€¢ ğŸ½ï¸ {{resep.porsi}} porsi</div>
      {{#if resep.deskripsi}}<p style="color:var(--warna-teks-sekunder);">{{resep.deskripsi}}</p>{{/if}}

      <hr style="margin:12px 0;" />

      <h3 class="kartu-judul" style="font-size:1rem;margin-top:8px;">ğŸ§¾ Bahan</h3>
      {{#if resep.daftarBahanDisplay.length}}
        <ul class="daftar-bahan-resep">
          {{#each resep.daftarBahanDisplay}}
            <li>{{this}}</li>
          {{/each}}
        </ul>
      {{else if resep.daftarBahan.length}}
        <ul class="daftar-bahan-resep">
          {{#each resep.daftarBahan}}
            <li>
              {{#if this.namaBahan}}{{this.namaBahan}}{{else if this.nama}}{{this.nama}}{{else if this.name}}{{this.name}}{{else}}{{this}}{{/if}}
              {{#if this.jumlah}} - {{this.jumlah}} {{this.satuan}}{{/if}}
            </li>
          {{/each}}
        </ul>
      {{else}}
        <p><em>Tidak ada informasi bahan.</em></p>
      {{/if}}

      <h3 class="kartu-judul" style="font-size:1rem;margin-top:12px;">ğŸ”ª Langkah</h3>
      {{#if resep.langkahDisplay.length}}
        <ol class="daftar-langkah-resep">
          {{#each resep.langkahDisplay}}
            <li>{{this}}</li>
          {{/each}}
        </ol>
      {{else if resep.langkah.length}}
        <ol class="daftar-langkah-resep">
          {{#each resep.langkah}}
            <li>
              {{#if this.deskripsi}}{{this.deskripsi}}{{else if this.text}}{{this.text}}{{else if this.instruksi}}{{this.instruksi}}{{else}}{{this}}{{/if}}
              {{#if this.durasiMenit}} <em>({{this.durasiMenit}} menit)</em>{{/if}}
              {{#if this.tips}}<div class="tip">ğŸ’¡ {{this.tips}}</div>{{/if}}
            </li>
          {{/each}}
        </ol>
      {{else}}
        {{#if resep.deskripsi}}
          <p>{{resep.deskripsi}}</p>
        {{else}}
          <p><em>Tidak ada instruksi langkah.</em></p>
        {{/if}}
      {{/if}}

      <div style="display:flex;gap:8px;margin-top:12px;align-items:center;">
        <a href="/resep" class="tombol-kirim">â† Kembali ke Daftar Resep</a>

        <div style="margin-left:auto;display:flex;align-items:center;gap:8px;">
{{#unless isAdmin}}
          <label for="inputPorsi" style="font-weight:600;color:var(--warna-teks-sekunder);">Porsi:</label>
          <input type="number" id="inputPorsi" min="1" step="1" value="{{resep.porsi}}" style="width:96px;padding:8px 10px;border-radius:8px;border:1px solid #e6e6e6;" />
          <!-- Masak button moved to the right of porsi -->
          <button id="tombolMasakKecil" class="tombol-mulai" style="margin-left:6px;" data-resep-id="{{resep._id}}" data-daftar-bahan='{{{resep.daftarBahanJSON}}}' data-base-porsi="{{resep.porsi}}">Masak</button>
{{/unless}}
        </div>
      </div>





      <!-- Konfirmasi Masak dinonaktifkan sementara. Interaksi Masak disederhanakan ke native confirm / aksi langsung. -->

      {{else}}
        <h2 class="kartu-judul">Resep tidak ditemukan</h2>
        <p>{{error}}</p>
        <div style="margin-top:12px;"><a href="/resep" class="tombol-kirim">â† Kembali ke Daftar Resep</a></div>
      {{/if}}
    </div>
  </section>
</main>


<!-- Konfirmasi masak HTML dihapus sementara -->

{{> footer}}