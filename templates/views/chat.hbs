<main class="kontainer-utama">
  <div class="container-chat-dengan-sidebar">
    <!-- Sidebar Session -->
    <aside class="sidebar-session" id="sidebarSession">
      <div class="sidebar-header">
        <span class="sidebar-title">üí¨ Sesi Chat</span>
        <button class="btn-session-baru" id="btnSessionBaru" title="Buat sesi baru">
          <span>+</span>
          <span>Baru</span>
        </button>
      </div>
      <div class="daftar-session" id="daftarSession">
        <!-- Sessions akan di-load oleh JavaScript -->
      </div>
    </aside>

    <!-- Main Chat Content -->
    <section class="konten-chat">
      <div class="header-chat-session" id="headerChatSession">
        <div class="info-session-aktif">
          <span class="nama-session-aktif" id="namaSessionAktif">Sesi Baru</span>
          <span class="tanggal-session" id="tanggalSessionAktif">Baru dibuat</span>
        </div>
        <button class="btn-edit-nama" id="btnEditNamaSession" title="Edit nama sesi">
          ‚úèÔ∏è Edit
        </button>
      </div>

      <div class="kartu kontainer-chat">
        <div class="area-pesan" id="areaPesan" role="log" aria-live="polite" aria-atomic="false">
          <!-- Messages will be restored from database and rendered by JS -->
        </div>
        <div id="indikatorMengetik" class="indikator-mengetik" style="display:none;"><span></span><span></span><span></span></div>
        <form class="form-chat" id="formChat" aria-label="Kirim pesan ke Koki AI">
          <input type="text" class="input-chat" id="inputPesan" placeholder="Ketik pesan Anda... (Enter untuk kirim)" aria-label="Teks pesan">
          <button type="submit" class="tombol-kirim" aria-label="Kirim pesan">Kirim</button>
        </form>
      </div>
    </section>
  </div>

  <!-- Modal Edit Nama Session -->
  <div class="modal-edit-nama" id="modalEditNama">
    <div class="konten-modal">
      <div class="modal-judul">Ubah Nama Sesi</div>
      <form id="formEditNama">
        <div class="form-group-modal">
          <label for="inputNamaSession">Nama Sesi Baru</label>
          <input type="text" id="inputNamaSession" placeholder="Masukkan nama sesi..." required>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-modal btn-modal-batal" id="btnBatalEditNama">
            Batal
          </button>
          <button type="submit" class="btn-modal btn-modal-simpan">
            Simpan
          </button>
        </div>
      </form>
    </div>
  </div>
</main>

<script>
  // Use the app's Socket.io chat rather than calling external APIs from the browser
  // (keeps API keys secret and reuses server-side Deepseek integration)
  document.addEventListener('DOMContentLoaded', () => {
    const input = document.getElementById('inputPesan');
    if (input) input.focus();

    // Allow Ctrl+Enter to submit quickly
    input?.addEventListener('keydown', (e) => {
      if (e.ctrlKey && e.key === 'Enter') {
        document.getElementById('formChat')?.dispatchEvent(new Event('submit', { bubbles: true, cancelable: true }));
      }
    });

    // Minor UX: show placeholder guidance
    const placeholder = input?.getAttribute('placeholder') || '';
    input?.setAttribute('placeholder', placeholder);
  });
</script>

{{> footer}}